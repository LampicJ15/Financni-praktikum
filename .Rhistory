z2 <- c(50,52.5,49.88,52.37,49.75,52.24)
c(60,58.8,57.62,58.78,59.95,61.15,62.37) ->z3
matrix(c(z1,z2,z3),3,6)
length(z1)
length(z2)
length(z3)
matrix(c(z1,z2),2)
z1
matrix(t(c(z1,z2)),2)
matrix(z1,z2)
matrix(z1,z2,2)
matrix(z1,z2,2,6)
z1
z2
matrix(z1,z2,6,2)
matrix(c(z1,z2),6,2)
t(matrix(c(z1,z2),6,2))
t(matrix(c(z1,z2),6,2)) ->v3
apply(v3,1,function(x) izplacilo(x,3,"call"))
monte <- function(S0,u,d,U,R,t,type,N){
p <- (1+R-d)/(u-d)
drevo <- matrix(rbinom(U*N,1,p),N,U) #stanja
drevo[drevo == 1]<- u #1 v matriki zamenjamo z u
drevo[drevo == 0]<- d #0 v matriki zamenjamo z vrednostjo d
drevo <- t( apply(drevo,1, cumprod))
vrednosti <- cbind(S0, S0*drevo)
izplacila <- apply(vrednosti,1, function(x) izplacilo(x,t,type))
premija <- ( sum(izplacila)/N )/(1+R)^U #sum(izplacila)/N je vzorčno povprečje
return(premija)
}
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte <- function(S0,u,d,U,R,t,type,N){
p <- (1+R-d)/(u-d)
drevo <- matrix(rbinom(U*N,1,p),N,U) #stanja
drevo[drevo == 1]<- u #1 v matriki zamenjamo z u
drevo[drevo == 0]<- d #0 v matriki zamenjamo z vrednostjo d
drevo <- t( apply(drevo,1, cumprod))
vrednosti <- cbind(S0, S0*drevo)
izplacila <- apply(vrednosti,1, function(x) izplacilo(x,t,type))
premija <- ( sum(izplacila)/N )/(1+R)^U #sum(izplacila)/N je vzorčno povprečje
return(premija)
}
monte <- function(S0,u,d,U,R,t,type,N){
p <- (1+R-d)/(u-d)
drevo <- matrix(rbinom(U*N,1,p),N,U) #stanja
drevo[drevo == 1]<- u #1 v matriki zamenjamo z u
drevo[drevo == 0]<- d #0 v matriki zamenjamo z vrednostjo d
drevo <- t( apply(drevo,1, cumprod))
vrednosti <- cbind(S0, S0*drevo)
izplacila <- apply(vrednosti,1, function(x) izplacilo(x,t,type))
premija <- ( sum(izplacila)/N )/(1+R)^U #sum(izplacila)/N je vzorčno povprečje
return(premija)
}
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(50,1.05,0.9,10,0.03,5,"call",100)
monte(70, 1.05, 1   ,  7,    0, 5, "put",2000)
monte(90, 1.15, 0.8 , 10, 0.01, 3, "call",50000)
drevo <- hcube(rep(2,U), translation = -1)
library(combinat)
library(Rlab)
library(dplyr)
drevo <- hcube(rep(2,U), translation = -1)
drevo
binomski <- function(S0,u,d,U,R,t,type){
p <- (1+R-d)/(u-d)
drevo <- hcube(rep(2,U), translation = -1) #drevo stanj 1 pomeni up 0 down
#izračun verjetnosti končnih stanj
k <- rowSums(drevo) #vektor, ki za vsako vrstico pove kolikorat je up
P.S <- p^k*(1-p)^(U-k) #vektor verjetnosti končnih stanj
drevo[drevo == 1]<- u #1 v matriki zamenjamo z u
drevo[drevo == 0]<- d #0 v matriki zamenjamo z vrednostjo d
drevo <- t( apply(drevo,1, cumprod)) #kumulativni produkt u in d po vrsticah
vrednosti <- cbind(S0, S0*drevo) #dobimo matriko, ki ima za vrstice vrednosti oz. vrsto za S0
izplacila <- apply(vrednosti,1, function(x) izplacilo(x,t,type)) #po vrsticah matrikah izvedemo funkcijo izplacila
E <- sum( izplacila * P.S) #upanje (skalarni produkt)
return(E/(1+R)^U)
}
binomski(50,1.05,0.95,5,0.03,3,"call")
binomski(90, 1.15, 0.8 , 10, 0.01, 3, "call")
binomski(80, 1.1 , 0.95,  9, 0.05, 4, "put" )
monte(60,1.05,0.95,15,0.01,8,"put",10)
monte(60,1.05,0.95,15,0.01,8,"put",100)
monte(60,1.05,0.95,15,0.01,8,"put",1000)
monte(60,1.05,0.95,15,0.01,8,"put",10) #7.222679
monte(60,1.05,0.95,15,0.01,8,"put",10) #7.222679
monte(60,1.05,0.95,15,0.01,8,"put",10) #7.222679
monte(60,1.05,0.95,15,0.01,8,"put",10) #7.222679
monte(60,1.05,0.95,15,0.01,8,"put",10) #7.222679
monte(60,1.05,0.95,15,0.01,8,"put",100) #5.466772
monte(60,1.05,0.95,15,0.01,8,"put",1000) #4.861408
monte(60,1.05,0.95,15,0.01,8,"put",1000) #4.861408
monte(60,1.05,0.95,15,0.01,8,"put",1000) #4.861408
N1 <- c()
N2 <- c()
N3 <- c()
for (i in c(1:M)){
N1 <- c(N1, monte(60,1.05,0.95,15,0.01,8,"put",10))
N2 <- c(N2, monte(60,1.05,0.95,15,0.01,8,"put",100))
N3 <- c(N3, monte(60,1.05,0.95,15,0.01,8,"put",1000))
}
N1 <- c()
N2 <- c()
N3 <- c()
M <- 100 #število simulacij
for (i in c(1:M)){
N1 <- c(N1, monte(60,1.05,0.95,15,0.01,8,"put",10))
N2 <- c(N2, monte(60,1.05,0.95,15,0.01,8,"put",100))
N3 <- c(N3, monte(60,1.05,0.95,15,0.01,8,"put",1000))
}
N1
histogram1 <-hist(N1,breaks = 50,
main = "Histogram premij opcije",
col ="cornflowerblue")
histogram1 <-hist(N1,breaks = 20,
main = "Histogram premij opcije",
col ="cornflowerblue")
histogram2 <-hist(N2,breaks = 20,
main = "Histogram premij opcije",
col ="red")
histogram2 <-hist(N2,breaks = 50,
main = "Histogram premij opcije",
col ="red")
histogram3 <-hist(N3,breaks = 20,
main = "Histogram premij opcije",
col ="orange")
histogram1 <-hist(N1,breaks = 50,
main = "Histogram premij opcije",
col ="cornflowerblue")
histogram2 <-hist(N2,breaks = 50,
main = "Histogram premij opcije",
col ="red")
histogram3 <-hist(N3,breaks = 50,
main = "Histogram premij opcije",
col ="orange")
histogram3 <-hist(N3,
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="orange")
histogram1 <-hist(N1,
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="cornflowerblue")
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlab = "Premija",
col ="red")
?istogram
?histogram
?hist
histogram1 <-hist(N1,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="cornflowerblue")
histogram2 <-hist(N2,breaks = "Sturges",
main = "Monte Carlo: N=100",
xlab = "Premija",
col ="red")
histogram3 <-hist(N3,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="orange")
?hist
histogram2 <-hist(N2,breaks = "Sturges",
main = "Monte Carlo: N=100",
xlim = c(0,8),
xlab = "Premija",
col ="red")
histogram2 <-hist(N2,breaks = 50,
main = "Monte Carlo: N=100",
xlim = c(0,8),
xlab = "Premija",
col ="red")
histogram2 <-hist(N2,breaks = 20,
main = "Monte Carlo: N=100",
xlim = c(0,8),
xlab = "Premija",
col ="red")
min <- min(c(N1,N2,N3))
min <- round(min(c(N1,N2,N3)))
?roundup
?round
min <- ceiling(min(c(N1,N2,N3)))
max <- ceiling(max(c(N1,N2,N3))
#histogram N1
histogram1 <-hist(N1,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="cornflowerblue")
#histogram N2
histogram2 <-hist(N2,breaks = 20,
main = "Monte Carlo: N=100",
xlab = "Premija",
col ="red")
#histogram N3
histogram3 <-hist(N3,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
col ="orange")
histogram1 <-hist(N1,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min,max),
col ="cornflowerblue")
min <- floor(min(c(N1,N2,N3)))
max <- ceiling(max(c(N1,N2,N3)))
histogram1 <-hist(N1,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
min <- floor(min(c(N1,N2,N3))) - 1
max <- ceiling(max(c(N1,N2,N3))) + 1
histogram1 <-hist(N1,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
histogram2 <-hist(N2,breaks = 20,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="red")
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="red")
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
histogram3 <-hist(N3,breaks = "Sturges",
main = "Monte Carlo: N=10",
xlim = c(min,max),
xlab = "Premija",
col ="orange")
histogram3 <-hist(N3,
main = "Monte Carlo: N=10",
xlim = c(min,max),
xlab = "Premija",
col ="orange")
histogram3 <-hist(N3,
main = "Monte Carlo: N=10",
xlim = c(min,max),
xlab = "Premija",
col ="orange")
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
min <- floor(min(c(N1,N2,N3)))
max <- ceiling(max(c(N1,N2,N3)))
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
histogram3 <-hist(N3,
main = "Monte Carlo: N=10",
xlim = c(min,max),
xlab = "Premija",
col ="orange")
?abline
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
abline(v=mean(N1),col="red")
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=mean(N2),col="red")
histogram3 <-hist(N3,
main = "Monte Carlo: N=1000",
xlim = c(min,max),
xlab = "Premija",
col ="green")
abline(v=mean(N3),col="red")
prem.opcije <- binomski(60,1.05,0.95,15,0.01,8,"put") #cena premije dobljena z binomksim modelom
?abline
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
abline(v=mean(N1),col="red")
abline(v=prem.opcije, col="red",lty=2)
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=mean(N2),col="red")
abline(v=prem.opcije, col="red",lty=2)
histogram3 <-hist(N3,
main = "Monte Carlo: N=1000",
xlim = c(min,max),
xlab = "Premija",
col ="green")
abline(v=mean(N3),col="red")
abline(v=prem.opcije, col="red",lty=2)
?arrows
var.N1 <- var(N1) #varianca vrednosti N1
var.N1
sqrt(4)
pov.N1 <- mean(N1) #povprečje vrednosti N1
odklon.N1 <- sqrt(var(N1)) #standardni odklon vrednosti N1
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
abline(v=pov.N1,col="red")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=odklon.N1,x2=-odklon.N1)
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="cornflowerblue")
arrows(pov.N1,0,x1=odklon.N1,x2=-odklon.N1)
pov.N1
pov.N1
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=odklon.N1,x2=-odklon.N1, col = "green")
?arrows
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=odklon.N1,x2=-odklon.N1, col = "green",length = 0.15,)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.15,)
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.015)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.1)
arrows(pov.N1,0,x1=pov.N1 + odklon.N1, col = "green",length = 0.1)
pov.N2 <- mean(N2) #povprečje vrednosti N2
odklon.N2 <- sqrt(var(N2)) #standardni odklon vrednosti N2
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=pov.N2,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N2,0,x1=pov.N2 - odklon.N2, col = "green",length = 0.1)
arrows(pov.N2,0,x1=pov.N2 + odklon.N2, col = "green",length = 0.1)
pov.N3 <- mean(N3) #povprečje vrednosti N3
odklon.N3 <- sqrt(var(N3)) #standardni odklon vrednosti N3
histogram3 <-hist(N3,
main = "Monte Carlo: N=1000",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=pov.N3,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N3,0,x1=pov.N3 - odklon.N3, col = "green",length = 0.1)
arrows(pov.N3,0,x1=pov.N3 + odklon.N3, col = "green",length = 0.1)
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.1)
arrows(pov.N1,0,x1=pov.N1 + odklon.N1, col = "green",length = 0.1)
legend('topright',
legend = c('monte Carlo', 'Analiza modela'),
col = c('green', 'reed'))
pov.N1 <- mean(N1) #povprečje vrednosti N1
odklon.N1 <- sqrt(var(N1)) #standardni odklon vrednosti N1
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.1)
arrows(pov.N1,0,x1=pov.N1 + odklon.N1, col = "green",length = 0.1)
legend('topright',
legend = c('monte Carlo', 'Analiza modela'),
col = c('green', 'reed'),
lty=1:1, cex=0.8)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'reed'),
lty=1:1, cex=0.8)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
lty=1:1, cex=0.8)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
lty=c("solid","dashed"))
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
lty=1:1, cex=0.8,
lty=c("solid","dashed"))
pov.N1 <- mean(N1) #povprečje vrednosti N1
odklon.N1 <- sqrt(var(N1)) #standardni odklon vrednosti N1
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.1)
arrows(pov.N1,0,x1=pov.N1 + odklon.N1, col = "green",length = 0.1)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
lty=1:1, cex=0.8,
lty=c("solid","dashed"))
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
cex=0.8,
lty=c("solid","dashed"))
pov.N1 <- mean(N1) #povprečje vrednosti N1
odklon.N1 <- sqrt(var(N1)) #standardni odklon vrednosti N1
histogram1 <-hist(N1,breaks = 20,
main = "Monte Carlo: N=10",
xlab = "Premija",
xlim = c(min, max),
col ="yellow")
abline(v=pov.N1,col="green")
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
cex=0.8,
lty=c("solid","dashed"))
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N1,0,x1=pov.N1 - odklon.N1, col = "green",length = 0.1)
arrows(pov.N1,0,x1=pov.N1 + odklon.N1, col = "green",length = 0.1)
pov.N2 <- mean(N2) #povprečje vrednosti N2
odklon.N2 <- sqrt(var(N2)) #standardni odklon vrednosti N2
histogram2 <-hist(N2,
main = "Monte Carlo: N=100",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=pov.N2,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N2,0,x1=pov.N2 - odklon.N2, col = "green",length = 0.1)
arrows(pov.N2,0,x1=pov.N2 + odklon.N2, col = "green",length = 0.1)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
cex=0.8,
lty=c("solid","dashed"))
pov.N3 <- mean(N3) #povprečje vrednosti N3
odklon.N3 <- sqrt(var(N3)) #standardni odklon vrednosti N3
histogram3 <-hist(N3,
main = "Monte Carlo: N=1000",
xlim = c(min,max),
xlab = "Premija",
col ="yellow")
abline(v=pov.N3,col="green")
abline(v=prem.opcije, col="red",lty=2)
arrows(pov.N3,0,x1=pov.N3 - odklon.N3, col = "green",length = 0.1)
arrows(pov.N3,0,x1=pov.N3 + odklon.N3, col = "green",length = 0.1)
legend('topright',
legend = c('Monte Carlo', 'Analiza modela'),
col = c('green', 'red'),
cex=0.8,
lty=c("solid","dashed"))
